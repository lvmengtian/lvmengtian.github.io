<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.161" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><link rel="icon" type="image/png" href="https://theme-plume.vuejs.press/favicon-32x32.png"><title>Spring | 浮梦札记</title><meta name="description" content=""><link rel="preload" href="/assets/style-DrEZvK8Z.css" as="style"><link rel="stylesheet" href="/assets/style-DrEZvK8Z.css"><link rel="modulepreload" href="/assets/app-DqL0oT9G.js"><link rel="modulepreload" href="/assets/index.html-BV3e-AbR.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-e1dbaae2><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-889cca3e></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-889cca3e> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-e1dbaae2 data-v-98c50ae5><div class="vp-navbar" vp-navbar data-v-98c50ae5 data-v-1eff3e5c><div class="wrapper" data-v-1eff3e5c><div class="container" data-v-1eff3e5c><div class="title" data-v-1eff3e5c><div class="vp-navbar-title has-sidebar" data-v-1eff3e5c data-v-a8561eab><a class="vp-link link no-icon title" href="/" data-v-a8561eab><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-77c293cb><!--]--><!--[--><img class="vp-image light logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-77c293cb><!--]--><!--]--><!--]--><span data-v-a8561eab>浮梦札记</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-1eff3e5c><div class="content-body" data-v-1eff3e5c><!--[--><!--]--><div class="vp-navbar-search search" data-v-1eff3e5c><div class="search-wrapper" data-v-3c688d23><!----><div id="local-search" data-v-3c688d23><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-3c688d23><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-1eff3e5c data-v-0840a817><span id="main-nav-aria-label" class="visually-hidden" data-v-0840a817>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/" tabindex="0" data-v-0840a817 data-v-950c9576><!--[--><!----><span data-v-950c9576>首页</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/java-guide/" tabindex="0" data-v-0840a817 data-v-950c9576><!--[--><!----><span data-v-950c9576>面试指北</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/notes/" tabindex="0" data-v-0840a817 data-v-950c9576><!--[--><!----><span data-v-950c9576>笔记</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/ai/" tabindex="0" data-v-0840a817 data-v-950c9576><!--[--><!----><span data-v-950c9576>AI</span><!----><!--]--><!----></a><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-1eff3e5c data-v-d98d8427><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-d98d8427 data-v-4421fe29 data-v-05519a3d><span class="check" data-v-05519a3d><span class="icon" data-v-05519a3d><!--[--><span class="vpi-sun sun" data-v-4421fe29></span><span class="vpi-moon moon" data-v-4421fe29></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-1eff3e5c data-v-ede9f760 data-v-2c613800><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-2c613800 data-v-dbe9afc8><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-1eff3e5c data-v-2ef44bf2 data-v-fd7634eb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-fd7634eb><span class="vpi-more-horizontal icon" data-v-fd7634eb></span></button><div class="menu" data-v-fd7634eb><div class="vp-menu" data-v-fd7634eb data-v-f00c3ea6><!----><!--[--><!--[--><!----><div class="group" data-v-2ef44bf2><div class="item appearance" data-v-2ef44bf2><p class="label" data-v-2ef44bf2>外观</p><div class="appearance-action" data-v-2ef44bf2><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-2ef44bf2 data-v-4421fe29 data-v-05519a3d><span class="check" data-v-05519a3d><span class="icon" data-v-05519a3d><!--[--><span class="vpi-sun sun" data-v-4421fe29></span><span class="vpi-moon moon" data-v-4421fe29></span><!--]--></span></span></button></div></div></div><div class="group" data-v-2ef44bf2><div class="item social-links" data-v-2ef44bf2><div class="vp-social-links social-links-list" data-v-2ef44bf2 data-v-2c613800><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-2c613800 data-v-dbe9afc8><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-1eff3e5c data-v-54c2ef6c><span class="container" data-v-54c2ef6c><span class="top" data-v-54c2ef6c></span><span class="middle" data-v-54c2ef6c></span><span class="bottom" data-v-54c2ef6c></span></span></button></div></div></div></div><div class="divider" data-v-1eff3e5c><div class="divider-line" data-v-1eff3e5c></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-e1dbaae2 data-v-734ba265><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-734ba265><span class="vpi-align-left menu-icon" data-v-734ba265></span><span class="menu-text" data-v-734ba265>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-734ba265 data-v-1e80eb91><button data-v-1e80eb91>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-e1dbaae2 data-v-aa9e4082><div class="curtain" data-v-aa9e4082></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-aa9e4082><span id="sidebar-aria-label" class="visually-hidden" data-v-aa9e4082> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-5ddb9693><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-5ddb9693 data-v-01c8a1fd><div class="item" role="button" tabindex="0" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><h2 class="text" data-v-01c8a1fd><span data-v-01c8a1fd>Java</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-01c8a1fd><span class="vpi-chevron-right caret-icon" data-v-01c8a1fd></span></div></div><div data-v-01c8a1fd data-v-01c8a1fd><div class="items" data-v-01c8a1fd><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-01c8a1fd data-v-01c8a1fd><div class="item" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><a class="vp-link link link" href="/java-guide/hg5e8awy/" data-v-01c8a1fd><!--[--><p class="text" data-v-01c8a1fd><span data-v-01c8a1fd>Java 基础</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-01c8a1fd data-v-01c8a1fd><div class="item" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><a class="vp-link link link" href="/java-guide/h9mgtev9/" data-v-01c8a1fd><!--[--><p class="text" data-v-01c8a1fd><span data-v-01c8a1fd>Java 集合</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-01c8a1fd data-v-01c8a1fd><div class="item" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><a class="vp-link link link" href="/java-guide/5qe4rxai/" data-v-01c8a1fd><!--[--><p class="text" data-v-01c8a1fd><span data-v-01c8a1fd>Java 并发编程</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-01c8a1fd data-v-01c8a1fd><div class="item" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><a class="vp-link link link" href="/java-guide/ypjcijom/" data-v-01c8a1fd><!--[--><p class="text" data-v-01c8a1fd><span data-v-01c8a1fd>Java 虚拟机</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-5ddb9693><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-5ddb9693 data-v-01c8a1fd><div class="item" role="button" tabindex="0" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><h2 class="text" data-v-01c8a1fd><span data-v-01c8a1fd>数据库</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-01c8a1fd><span class="vpi-chevron-right caret-icon" data-v-01c8a1fd></span></div></div><div data-v-01c8a1fd data-v-01c8a1fd><div class="items" data-v-01c8a1fd><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-01c8a1fd data-v-01c8a1fd><div class="item" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><a class="vp-link link link" href="/java-guide/396o7sc3/" data-v-01c8a1fd><!--[--><p class="text" data-v-01c8a1fd><span data-v-01c8a1fd>MySQL</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-5ddb9693><section class="vp-sidebar-item sidebar-item level-0 collapsible has-active" data-v-5ddb9693 data-v-01c8a1fd><div class="item" role="button" tabindex="0" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><h2 class="text" data-v-01c8a1fd><span data-v-01c8a1fd>Spring</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-01c8a1fd><span class="vpi-chevron-right caret-icon" data-v-01c8a1fd></span></div></div><div data-v-01c8a1fd data-v-01c8a1fd><div class="items" data-v-01c8a1fd><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-01c8a1fd data-v-01c8a1fd><div class="item" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><a class="vp-link link link" href="/java-guide/ysb3pgbj/" data-v-01c8a1fd><!--[--><p class="text" data-v-01c8a1fd><span data-v-01c8a1fd>Spring</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-5ddb9693><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-5ddb9693 data-v-01c8a1fd><div class="item" role="button" tabindex="0" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><h2 class="text" data-v-01c8a1fd><span data-v-01c8a1fd>其他</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-01c8a1fd><span class="vpi-chevron-right caret-icon" data-v-01c8a1fd></span></div></div><div data-v-01c8a1fd data-v-01c8a1fd><div class="items" data-v-01c8a1fd><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-01c8a1fd data-v-01c8a1fd><div class="item" data-v-01c8a1fd><div class="indicator" data-v-01c8a1fd></div><!----><a class="vp-link link link" href="/java-guide/nkmdr64r/" data-v-01c8a1fd><!--[--><p class="text" data-v-01c8a1fd><span data-v-01c8a1fd>软技能</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-e1dbaae2 data-v-4f97ed91><div class="vp-doc-container has-sidebar has-aside" data-v-4f97ed91 data-v-79596a8a><!--[--><!--]--><div class="container" data-v-79596a8a><div class="aside" vp-outline data-v-79596a8a><div class="aside-curtain" data-v-79596a8a></div><div class="aside-container" data-v-79596a8a><div class="aside-content" data-v-79596a8a><div class="vp-doc-aside" data-v-79596a8a data-v-95f703c6><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-95f703c6 data-v-937f11d8><div class="content" data-v-937f11d8><div class="outline-marker" data-v-937f11d8></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-937f11d8><span data-v-937f11d8>此页内容</span><span class="vpi-print icon" data-v-937f11d8></span></div><ul class="root" data-v-937f11d8 data-v-8fe7a250><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-95f703c6></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-79596a8a><div class="content-container" data-v-79596a8a><!--[--><!--]--><main class="main" data-v-79596a8a><nav class="vp-breadcrumb" data-v-79596a8a data-v-06b62c47><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-06b62c47><!--[--><li property="itemListElement" typeof="ListItem" data-v-06b62c47><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-06b62c47><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-06b62c47></span><meta property="name" content="首页" data-v-06b62c47><meta property="position" content="1" data-v-06b62c47></li><li property="itemListElement" typeof="ListItem" data-v-06b62c47><span class="vp-link breadcrumb" property="item" typeof="WebPage" data-v-06b62c47><!--[-->Spring<!--]--><!----></span><span class="vpi-chevron-right" data-v-06b62c47></span><meta property="name" content="Spring" data-v-06b62c47><meta property="position" content="2" data-v-06b62c47></li><li property="itemListElement" typeof="ListItem" data-v-06b62c47><a class="vp-link link breadcrumb current" href="/java-guide/ysb3pgbj/" property="item" typeof="WebPage" data-v-06b62c47><!--[-->Spring<!--]--><!----></a><!----><meta property="name" content="Spring" data-v-06b62c47><meta property="position" content="3" data-v-06b62c47></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-09347631><!----> Spring <!----></h1><div class="vp-doc-meta" data-v-09347631><!--[--><!--]--><p class="reading-time" data-v-09347631><span class="vpi-books icon" data-v-09347631></span><span data-v-09347631>约 864 字</span><span data-v-09347631>大约 3 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-09347631><span class="vpi-clock icon" data-v-09347631></span><span data-v-09347631>2025-11-28</span></p></div><!--]--><!--[--><!--]--><div class="_java-guide_ysb3pgbj_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-79596a8a><!--[--><!--]--><div data-v-79596a8a><h2 id="spring如何解决循环依赖" tabindex="-1"><a class="header-anchor" href="#spring如何解决循环依赖"><span>Spring如何解决循环依赖</span></a></h2><blockquote><p>“在Spring的世界里，Bean就像一群需要互相协作的同事。但有时会出现一种尴尬的局面：</p><ul><li>A同事说：‘不行，我得等B把方案给我，我才能开始工作。’</li><li>B同事说：‘不行，我得等A把资料给我，我才能动工。’</li></ul><p>这就形成了 <strong>‘循环依赖’</strong>。在Spring中，如果两个Bean（如A和B）互相依赖（A依赖B，B也依赖A），Spring是如何处理，而不让整个应用启动失败的呢？今天小毛带你深入三级缓存，看看Spring的神来之笔。”</p></blockquote><h3 id="🤔-循环依赖会报错吗" tabindex="-1"><a class="header-anchor" href="#🤔-循环依赖会报错吗"><span>🤔 <strong>循环依赖会报错吗？</strong></span></a></h3><p><strong>结论是：不一定，分情况讨论。</strong></p><ol><li><strong>大部分情况下，不报错</strong>：Spring框架<strong>内置了一套成熟的机制（三级缓存）</strong> 来解决常见的循环依赖问题。</li><li><strong>特定情况下，会报错</strong>：如果Spring无法解决，它会抛出 <code>BeanCurrentlyInCreationException</code> 异常。</li></ol><p><strong>关键在于：<!----></strong></p><h3 id="📚-spring的解决方案-三级缓存架构" tabindex="-1"><a class="header-anchor" href="#📚-spring的解决方案-三级缓存架构"><span>📚 <strong>Spring的解决方案：三级缓存架构</strong></span></a></h3><p>我们先来理解Spring为解决循环依赖准备的“三级仓库”：</p><table><thead><tr><th style="text-align:left;">缓存名称</th><th style="text-align:left;">源码中名称</th><th style="text-align:left;">存储内容</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>一级缓存 (单例池)</strong></td><td style="text-align:left;"><code>singletonObjects</code></td><td style="text-align:left;"><strong>完整的单例Bean</strong></td><td style="text-align:left;">存放已经完全初始化好的Bean，对外提供使用。</td></tr><tr><td style="text-align:left;"><strong>二级缓存 (早期曝光)</strong></td><td style="text-align:left;"><code>earlySingletonObjects</code></td><td style="text-align:left;"><strong>早期的Bean对象</strong> (尚未填充属性)</td><td style="text-align:left;">存放刚从三级缓存中取出的对象，避免代理对象被重复创建。</td></tr><tr><td style="text-align:left;"><strong>三级缓存 (对象工厂)</strong></td><td style="text-align:left;"><code>singletonFactories</code></td><td style="text-align:left;"><strong>ObjectFactory</strong> (用于生成早期对象的工厂)</td><td style="text-align:left;"><strong>解决循环依赖的关键</strong>，存放一个能生成早期Bean引用（可能是代理对象）的工厂。</td></tr></tbody></table><h3 id="🔍-解决流程详解" tabindex="-1"><a class="header-anchor" href="#🔍-解决流程详解"><span>🔍 <strong>解决流程详解</strong></span></a></h3><p>让我们以经典的属性注入循环依赖 <code>A -&gt; B -&gt; A</code> 为例，来看Spring如何通过三级缓存破解这个“死结”： <img src="/images/spring_third_cache.png" alt=""></p><p><strong>流程核心要点：</strong></p><ol><li><strong>破局点在于“实例化”和“依赖注入”的分离</strong>：Spring先把Bean的“空壳”（对象实例）创建出来，并不等它完全填满属性，就提前把这个“空壳”的引用暴露出去。</li><li><strong>三级缓存是核心</strong>：它存放的是一个工厂。这个工厂的最大作用是<strong>在需要的时候能够返回一个早期引用，并且能处理AOP代理问题</strong>。如果直接把这个早期引用放在二级缓存，那么遇到AOP时，就无法保证返回的是同一个代理对象。</li><li><strong>升级缓存</strong>：当某个Bean的早期引用被其他Bean依赖后，它会被从三级缓存升级到二级缓存。</li></ol><h3 id="🌰-无法解决的循环依赖场景" tabindex="-1"><a class="header-anchor" href="#🌰-无法解决的循环依赖场景"><span>🌰 <strong>无法解决的循环依赖场景</strong></span></a></h3><p>Spring不是万能的，在以下情况下，循环依赖会<strong>报错</strong>：</p><ol><li><p><strong>构造器循环依赖</strong>：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">Service</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> A</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    private</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> B</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> A</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">B </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 通过构造器注入B</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">Service</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> B</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    private</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> A</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> B</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">A </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 通过构造器注入A</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>原因</strong>：在实例化A的时候，就需要一个完整的B；而实例化B又需要一个完整的A。双方连“空壳”都创建不出来，死锁无法破解。</p></li><li><p><strong>Prototype作用域的Bean循环依赖</strong>： <strong>原因</strong>：Spring不缓存Prototype类型的Bean，所以无法提供早期暴露的引用。</p></li><li><p><strong>@Async方法导致的循环依赖</strong>等特殊情况。</p></li></ol></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-79596a8a data-v-132f89cc><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-132f89cc><span class="contributors-label" data-v-132f89cc>贡献者: </span><span class="contributors-info" data-v-132f89cc><!--[--><!--[--><span class="contributor" data-v-132f89cc>lvmengtian</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-132f89cc><div class="pager" data-v-132f89cc><a class="vp-link link pager-link prev" href="/java-guide/396o7sc3/" data-v-132f89cc><!--[--><span class="desc" data-v-132f89cc>上一页</span><span class="title" data-v-132f89cc>MySQL</span><!--]--><!----></a></div><div class="pager" data-v-132f89cc><a class="vp-link link pager-link next" href="/java-guide/nkmdr64r/" data-v-132f89cc><!--[--><span class="desc" data-v-132f89cc>下一页</span><span class="title" data-v-132f89cc>软技能</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button type="button" class="vp-back-to-top" aria-label="back to top" data-v-e1dbaae2 style="display:none;" data-v-64659f34><span class="percent" data-allow-mismatch data-v-64659f34>0%</span><span class="show icon vpi-back-to-top" data-v-64659f34></span><svg aria-hidden="true" data-v-64659f34><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-64659f34></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-e1dbaae2 data-v-cbcd6b75><!--[--><div class="container" data-v-cbcd6b75><p class="message" data-v-cbcd6b75>Powered by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-DqL0oT9G.js" defer></script></body></html>